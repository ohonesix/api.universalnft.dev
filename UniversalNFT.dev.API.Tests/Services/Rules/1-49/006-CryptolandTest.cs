using NSubstitute;

namespace UniversalNFT.dev.API.Tests.Services.Rules
{
    public class CryptolandTest : BaseRuleTest
    {
        [Test]
        public async Task GivenNFT_ReturnsImageAsync()
        {
            // Arrange
            Token.URI = TestConstants.MetaJsonUrl;

            var metaJson = @"{""schema"": ""https://ingameassets.cryptoland.host/cryptopian/cryptopian.v1.schema.json"", ""nftType"": ""art.v0"", ""name"": ""Cryptopian #200"", ""nftId"": ""200"", ""description"": ""This is a member of the Cryptopian society on Planet CryCor. They are the remenants of the original clones that were sent to colonize the planet.  They all are in a race for power and control to Own. Earn. and Conquer."", ""image"": ""https://community-cryptoland-2.nyc3.cdn.digitaloceanspaces.com/upload/cryptopian/image/Cryptopian200.png"", ""animation"": ""https://community-cryptoland-2.nyc3.cdn.digitaloceanspaces.com/upload/cryptopian/animation/reveal-male-miner.gif"", ""video"": ""https://community-cryptoland-2.nyc3.cdn.digitaloceanspaces.com/upload/cryptopian/video/reveal-male-miner.mp4"", ""audio"": ""https://community-cryptoland-2.nyc3.cdn.digitaloceanspaces.com/upload/cryptopian/audio/Cryptopian200.mp3"", ""file"": ""https://community-cryptoland-2.nyc3.cdn.digitaloceanspaces.com/upload/cryptopian/file/Cryptopian200.html"", ""collection"": {""name"": ""Cryptoland Cryptopians"", ""family"": ""Avatars""}, ""attributes"": [{""trait_type"": ""Sex"", ""value"": ""Male""}, {""trait_type"": ""Class"", ""value"": ""Miner""}, {""trait_type"": ""Subclass"", ""value"": ""Ventilation""}, {""trait_type"": ""Background"", ""value"": ""Amber Background""}, {""trait_type"": ""Border"", ""value"": ""Green Border""}, {""trait_type"": ""Skin Color"", ""value"": ""Blue Chimera Skin""}, {""trait_type"": ""Eye Base"", ""value"": ""Black Eyes""}, {""trait_type"": ""Iris Color"", ""value"": ""Emerald Irises""}, {""trait_type"": ""Mouth Expression"", ""value"": ""Skeptical""}, {""trait_type"": ""Brow Expression"", ""value"": ""Skeptical""}, {""trait_type"": ""Tattoo"", ""value"": ""Fractal Equality Tattoo""}, {""trait_type"": ""Burn Scar"", ""value"": ""Not Burned""}, {""trait_type"": ""Warpaint"", ""value"": ""No Warpaint""}, {""trait_type"": ""Scars"", ""value"": ""No Scars""}, {""trait_type"": ""Hair Style"", ""value"": ""Bald""}, {""trait_type"": ""Hair Color"", ""value"": ""None""}, {""trait_type"": ""Beard Style"", ""value"": ""Goatee""}, {""trait_type"": ""Beard Color"", ""value"": ""Black Facial Hair""}, {""trait_type"": ""Flame Brows"", ""value"": ""No Special Brows""}, {""trait_type"": ""Hat"", ""value"": ""Clean White Linen Coif with Helmet""}, {""trait_type"": ""Accessory"", ""value"": ""Iron Craftsman Pickaxe""}, {""trait_type"": ""Clothing 1"", ""value"": ""Rolled Up Gray Shirt""}, {""trait_type"": ""Clothing 2"", ""value"": ""null""}, {""trait_type"": ""Clothing 3"", ""value"": ""null""}, {""trait_type"": ""Clothing 4"", ""value"": ""null""}, {""trait_type"": ""Clothing 5"", ""value"": ""null""}, {""trait_type"": ""Clothing 6"", ""value"": ""null""}, {""trait_type"": ""Clothing 7"", ""value"": ""null""}, {""trait_type"": ""Clothing 8"", ""value"": ""null""}, {""trait_type"": ""Necklaces"", ""value"": ""No Necklace""}, {""trait_type"": ""Nose Rings"", ""value"": ""null""}, {""trait_type"": ""Level"", ""value"": ""3""}, {""trait_type"": ""Health Points"", ""value"": ""6""}, {""trait_type"": ""Attack Points"", ""value"": ""1""}, {""trait_type"": ""Defense Points"", ""value"": ""1""}, {""trait_type"": ""Mining"", ""value"": ""YES""}, {""trait_type"": ""Thieving"", ""value"": ""NO""}, {""trait_type"": ""Forging"", ""value"": ""NO""}, {""trait_type"": ""Raiding"", ""value"": ""NO""}, {""trait_type"": ""Fabricating"", ""value"": ""NO""}, {""trait_type"": ""Governing"", ""value"": ""NO""}, {""trait_type"": ""Ruling"", ""value"": ""NO""}, {""trait_type"": ""Collect Tithes"", ""value"": ""NO""}, {""trait_type"": ""Can Use Vials"", ""value"": ""YES""}, {""trait_type"": ""Helmet"", ""value"": ""NO""}, {""trait_type"": ""Breastplate"", ""value"": ""NO""}, {""trait_type"": ""Gauntlet"", ""value"": ""NO""}, {""trait_type"": ""Boots"", ""value"": ""NO""}, {""trait_type"": ""Mainhand Weapon"", ""value"": ""NO""}, {""trait_type"": ""Offhand Weapon"", ""value"": ""NO""}], ""additional"": null, ""issuer"": ""rPeRQQ8kaMej5b1E7tjkwFPm2xMFQofkdG"", ""network"": ""XLS20""}";

            _mockHttpFacade.GetData(TestConstants.MetaJsonUrl).Returns(metaJson);

            // Act
            var result = await _classUnderTest.ProcessNFToken(Token);

            // Assert
            Assert.That(result, Is.EqualTo("https://community-cryptoland-2.nyc3.cdn.digitaloceanspaces.com/upload/cryptopian/image/Cryptopian200.png"));
        }
    }
}